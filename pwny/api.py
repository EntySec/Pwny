from pwny.types import *

TAB_BASE = 1

API_CALL = 1
API_TYPE = 1

API_CALL_STATIC = 10000
API_CALL_DYNAMIC = 40000

"""
BUILTINS API
"""

BUILTIN_BASE = 1

BUILTIN_TYPE_PLATFORM = tlv_custom_type(TLV_TYPE_STRING, 1)
BUILTIN_TYPE_VERSION = tlv_custom_type(TLV_TYPE_STRING, 2)
BUILTIN_TYPE_ARCH = tlv_custom_type(TLV_TYPE_STRING, 3)
BUILTIN_TYPE_MACHINE = tlv_custom_type(TLV_TYPE_STRING, 4)
BUILTIN_TYPE_VENDOR = tlv_custom_type(TLV_TYPE_STRING, 5)

BUILTIN_QUIT = tlv_custom_tag(API_CALL_STATIC, BUILTIN_BASE, API_CALL)
BUILTIN_ADD_NODE = tlv_custom_tag(API_CALL_STATIC, BUILTIN_BASE, API_CALL + 1)
BUILTIN_DEL_NODE = tlv_custom_tag(API_CALL_STATIC, BUILTIN_BASE, API_CALL + 2)
BUILTIN_ADD_TAB_DISK = tlv_custom_tag(API_CALL_STATIC, BUILTIN_BASE, API_CALL + 3)
BUILTIN_ADD_TAB_BUFFER = tlv_custom_tag(API_CALL_STATIC, BUILTIN_BASE, API_CALL + 4)
BUILTIN_DEL_TAB = tlv_custom_tag(API_CALL_STATIC, BUILTIN_BASE, API_CALL + 5)
BUILTIN_MIGRATE = tlv_custom_tag(API_CALL_STATIC, BUILTIN_BASE, API_CALL + 6)
BUILTIN_PULL = tlv_custom_tag(API_CALL_STATIC, BUILTIN_BASE, API_CALL + 7)
BUILTIN_PUSH = tlv_custom_tag(API_CALL_STATIC, BUILTIN_BASE, API_CALL + 8)
BUILTIN_SYSINFO = tlv_custom_tag(API_CALL_STATIC, BUILTIN_BASE, API_CALL + 9)

"""
PROCESS API
"""

PROCESS_BASE = 2

PROCESS_TYPE_PID_STATE = tlv_custom_type(TLV_TYPE_PID, 1)
PROCESS_TYPE_PID_CPU = tlv_custom_type(TLV_TYPE_PID, 2)

PROCESS_LIST = tlv_custom_tag(API_CALL_STATIC, PROCESS_BASE, API_CALL)
PROCESS_KILL = tlv_custom_tag(API_CALL_STATIC, PROCESS_BASE, API_CALL + 1)
PROCESS_GET_PID = tlv_custom_tag(API_CALL_STATIC, PROCESS_BASE, API_CALL + 2)
